csvm,1,12,,,,,,
noop,# cpu!A2 is the current sprite index,,,,,,,
noop,# cpu!B2 is the scratch register,,,,,,,
noop,"# cpu!A3:E3 = unpacked pointer to blit destination, F3 is packed reference",,,,,,,
call,*A51,,,,,,,
copy,*R[0]C4:R[0]C8,*cpu!A3:E3,display,column,row,8,8,
define,outer,*R[2]C1,,,,,,
define,inner,*R[3]C1,# loop restart,,,,,
clear,*display!A2:BL65,,# clear the display,,,,,
copy,1,*cpu!A2,# initialize the sprite position pointer,,,,,
call,*A20,,# call draw(),,,,,
add,*cpu!A2,1,# increment the sprite index,,,,,
gt,7,*cpu!A2,*inner,,,,,
sleep,,,,,,,,
copy,1,*display!D1,# update the screen,,,,,
jump,*outer,,,,,,,
,,,,,,,,
,,,,,,,,
# draw(),,,,,,,,
copy,*clock,*cpu!B2,,,,,,
mult,*cpu!B2,0.0013,,,,,,
add,*cpu!B2,*cpu!A2,,,,,,
sin,*cpu!B2,,,,,,,
mult,*cpu!B2,24,,,,,,
add,*cpu!B2,29,,,,,,
floor,*cpu!B2,,,,,,,
copy,*cpu!B2,*cpu!B3,,,,,,
copy,*clock,*cpu!B2,,,,,,
mult,*cpu!B2,0.0018,,,,,,
add,*cpu!B2,*cpu!A2,,,,,,
cos,*cpu!B2,,,,,,,
mult,*cpu!B2,24,,,,,,
add,*cpu!B2,29,,,,,,
floor,*cpu!B2,,,,,,,
copy,*cpu!B2,*cpu!C3,,,,,,
address,*cpu!A3:E3,*cpu!F3,# create the display sheet destination pointer,,,,,
copy,*A41:H48,&cpu!F3,# blit the sprite,,,,,
return,,,,,,,,
,,,,,,,,
# sprite data,,,,,,,,
,3,3,3,3,3,3,,
3,3,,3,3,,3,3,
3,3,2,3,3,2,3,3,
3,3,3,3,3,3,3,3,
3,,3,3,3,3,,3,
3,,,,,,,3,
3,3,1,1,1,1,3,3,
,3,3,3,3,3,3,,
,,,,,,,,
# setupAudio(),,,,,,,,
copy,*R[0]C4:R[0]C9,*synth!A2:G2,sine,220,0.2,1,,*A61
copy,*R[0]C4:R[0]C9,*synth!A3:G3,triangle,147,1.6,0.3,0,*F61
return,,,,,,,,
,,,,,,,,
,,,,,,,,
,,,,,,,,
,,,,,,,,
,,,,,,,,
# audio interrupt handlers,,,,,,,,
# scale,,,,,# bassline,,,
mult,*E51,1.05,,,gt,*E52,147,
gt,440,*E51,*A64,,copy,294,*E52,
copy,220,*E51,,,jump,*A72,,
copy,*E51,*synth!B2,,,copy,147,*E52,
return,,,,,copy,*E52,*synth!B3,
,,,,,return,,,
,,,,,,,,
# audio queue,,,,,,,,
,,,,,,,,
,,,,,,,,
,,,,,,,,
# audio tracks,,,,,,,,
